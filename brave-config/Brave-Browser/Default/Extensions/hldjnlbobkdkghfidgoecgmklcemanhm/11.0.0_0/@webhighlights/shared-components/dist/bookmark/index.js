/*! For license information please see index.js.LICENSE.txt */
(()=>{var t={66138:(t,i,e)=>{"use strict";e.r(i),e.d(i,{default:()=>l});var o=e(36758),s=e.n(o),r=e(40935),n=e.n(r)()(s());n.push([t.id,".wh-loading-skeleton{color:rgba(0,0,0,0);opacity:.8;animation:1.25s linear 0s infinite normal none running loadingBlinking}@keyframes loadingBlinking{0%{background:rgba(140,140,140,.15)}70%{background:rgba(67,79,86,.15)}100%{background:rgba(112,145,169,.15)}}:host{box-sizing:border-box;cursor:pointer;display:flex;flex-wrap:wrap;padding:10px;width:100%;--font-size-small: 14px;transition-duration:.15s;transition-timing-function:ease-in-out}webhighlights-bookmark-header{padding:4px 8px}webhighlights-blockquote{padding:8px 4px 10px 4px;display:flex;flex-wrap:wrap;margin:14px 0}.bookmark-link{color:inherit;cursor:inherit;text-decoration:none;width:100%}.footer{display:flex;padding-left:8px;padding-top:8px;width:100%;height:25px;color:var(--color);font-size:12px}.footer .tags{width:60%;overflow:auto;display:flex;flex-wrap:wrap}.footer .tags::-webkit-scrollbar{display:none}.footer .tags .tag{padding:1px 6px;cursor:pointer;margin-right:4px;margin-bottom:4px;color:var(--wh-text-light);background-color:var(--wh-bg-back);border-radius:100px;display:flex;align-items:center}.footer .tags .tag:hover{background-color:var(--wh-bg-back-hover)}.footer .highlights-notes-info{margin-left:auto}.footer.loading .highlights-notes-info{color:rgba(0,0,0,0);opacity:.8;animation:.75s linear .25s infinite normal none running loadingBlinking}.footer.loading .tags{display:flex;overflow-x:auto}.footer.loading .tags .tag{color:rgba(0,0,0,0);opacity:.8;animation:.75s linear .25s infinite normal none running loadingBlinking;width:40px;margin-right:4px;border-radius:10px}webhighlights-link-preview{width:100%}webhighlights-link-preview.explore{border-radius:10px;margin-bottom:10px;margin:10px 0}webhighlights-link-preview.private{width:100%;border:none}webhighlights-bookmark-explore-toolbar,webhighlights-blockquotes-teaser{width:100%;display:flex;align-items:center;cursor:auto}",""]);const l=n},40935:t=>{"use strict";t.exports=function(t){var i=[];return i.toString=function(){return this.map((function(i){var e="",o=void 0!==i[5];return i[4]&&(e+="@supports (".concat(i[4],") {")),i[2]&&(e+="@media ".concat(i[2]," {")),o&&(e+="@layer".concat(i[5].length>0?" ".concat(i[5]):""," {")),e+=t(i),o&&(e+="}"),i[2]&&(e+="}"),i[4]&&(e+="}"),e})).join("")},i.i=function(t,e,o,s,r){"string"==typeof t&&(t=[[null,t,void 0]]);var n={};if(o)for(var l=0;l<this.length;l++){var a=this[l][0];null!=a&&(n[a]=!0)}for(var h=0;h<t.length;h++){var d=[].concat(t[h]);o&&n[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),e&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=e):d[2]=e),s&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=s):d[4]="".concat(s)),i.push(d))}},i}},36758:t=>{"use strict";t.exports=function(t){return t[1]}},88373:(t,i,e)=>{var o=e(66138);o&&o.__esModule&&(o=o.default),t.exports="string"==typeof o?o:o.toString()},30827:(t,i,e)=>{"use strict";e.d(i,{y:()=>r});var o=e(38085),s=e(93811);class r extends s.LitElement{constructor(){super(...arguments),this.components=[]}connectedCallback(){super.connectedCallback(),(0,o.lazyDefine)(this.components)}static define(t,i,e){(0,o.defineWebHighlightsElement)(t,i,e)}}},95665:t=>{"use strict";t.exports=LitDecoratorsExternal},93811:t=>{"use strict";t.exports=LitExternal},38085:t=>{"use strict";t.exports=WebHighlightsSharedLibExternal},31006:(t,i,e)=>{"use strict";e.d(i,{J:()=>s});var o=e(80181);const s=t=>t??o.s6},80181:(t,i,e)=>{"use strict";e.d(i,{s6:()=>y});const o=globalThis,s=o.trustedTypes,r=s?s.createPolicy("lit-html",{createHTML:t=>t}):void 0,n="$lit$",l=`lit$${Math.random().toFixed(9).slice(2)}$`,a="?"+l,h=`<${a}>`,d=document,p=()=>d.createComment(""),c=t=>null===t||"object"!=typeof t&&"function"!=typeof t,g=Array.isArray,u="[ \t\n\f\r]",v=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,k=/-->/g,m=/>/g,$=RegExp(`>|${u}(?:([^\\s"'>=/]+)(${u}*=${u}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),f=/'/g,b=/"/g,_=/^(?:script|style|textarea|title)$/i,A=t=>(i,...e)=>({_$litType$:t,strings:i,values:e}),x=(A(1),A(2),A(3),Symbol.for("lit-noChange")),y=Symbol.for("lit-nothing"),w=new WeakMap,T=d.createTreeWalker(d,129);function C(t,i){if(!g(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==r?r.createHTML(i):i}const H=(t,i)=>{const e=t.length-1,o=[];let s,r=2===i?"<svg>":3===i?"<math>":"",a=v;for(let i=0;i<e;i++){const e=t[i];let d,p,c=-1,g=0;for(;g<e.length&&(a.lastIndex=g,p=a.exec(e),null!==p);)g=a.lastIndex,a===v?"!--"===p[1]?a=k:void 0!==p[1]?a=m:void 0!==p[2]?(_.test(p[2])&&(s=RegExp("</"+p[2],"g")),a=$):void 0!==p[3]&&(a=$):a===$?">"===p[0]?(a=s??v,c=-1):void 0===p[1]?c=-2:(c=a.lastIndex-p[2].length,d=p[1],a=void 0===p[3]?$:'"'===p[3]?b:f):a===b||a===f?a=$:a===k||a===m?a=v:(a=$,s=void 0);const u=a===$&&t[i+1].startsWith("/>")?" ":"";r+=a===v?e+h:c>=0?(o.push(d),e.slice(0,c)+n+e.slice(c)+l+u):e+l+(-2===c?i:u)}return[C(t,r+(t[e]||"<?>")+(2===i?"</svg>":3===i?"</math>":"")),o]};class E{constructor({strings:t,_$litType$:i},e){let o;this.parts=[];let r=0,h=0;const d=t.length-1,c=this.parts,[g,u]=H(t,i);if(this.el=E.createElement(g,e),T.currentNode=this.el.content,2===i||3===i){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(o=T.nextNode())&&c.length<d;){if(1===o.nodeType){if(o.hasAttributes())for(const t of o.getAttributeNames())if(t.endsWith(n)){const i=u[h++],e=o.getAttribute(t).split(l),s=/([.?@])?(.*)/.exec(i);c.push({type:1,index:r,name:s[2],strings:e,ctor:"."===s[1]?B:"?"===s[1]?D:"@"===s[1]?I:M}),o.removeAttribute(t)}else t.startsWith(l)&&(c.push({type:6,index:r}),o.removeAttribute(t));if(_.test(o.tagName)){const t=o.textContent.split(l),i=t.length-1;if(i>0){o.textContent=s?s.emptyScript:"";for(let e=0;e<i;e++)o.append(t[e],p()),T.nextNode(),c.push({type:2,index:++r});o.append(t[i],p())}}}else if(8===o.nodeType)if(o.data===a)c.push({type:2,index:r});else{let t=-1;for(;-1!==(t=o.data.indexOf(l,t+1));)c.push({type:7,index:r}),t+=l.length-1}r++}}static createElement(t,i){const e=d.createElement("template");return e.innerHTML=t,e}}function S(t,i,e=t,o){if(i===x)return i;let s=void 0!==o?e._$Co?.[o]:e._$Cl;const r=c(i)?void 0:i._$litDirective$;return s?.constructor!==r&&(s?._$AO?.(!1),void 0===r?s=void 0:(s=new r(t),s._$AT(t,e,o)),void 0!==o?(e._$Co??=[])[o]=s:e._$Cl=s),void 0!==s&&(i=S(t,s._$AS(t,i.values),s,o)),i}class N{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:e}=this._$AD,o=(t?.creationScope??d).importNode(i,!0);T.currentNode=o;let s=T.nextNode(),r=0,n=0,l=e[0];for(;void 0!==l;){if(r===l.index){let i;2===l.type?i=new O(s,s.nextSibling,this,t):1===l.type?i=new l.ctor(s,l.name,l.strings,this,t):6===l.type&&(i=new L(s,this,t)),this._$AV.push(i),l=e[++n]}r!==l?.index&&(s=T.nextNode(),r++)}return T.currentNode=d,o}p(t){let i=0;for(const e of this._$AV)void 0!==e&&(void 0!==e.strings?(e._$AI(t,e,i),i+=e.strings.length-2):e._$AI(t[i])),i++}}class O{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,e,o){this.type=2,this._$AH=y,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=e,this.options=o,this._$Cv=o?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return void 0!==i&&11===t?.nodeType&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=S(this,t,i),c(t)?t===y||null==t||""===t?(this._$AH!==y&&this._$AR(),this._$AH=y):t!==this._$AH&&t!==x&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):(t=>g(t)||"function"==typeof t?.[Symbol.iterator])(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==y&&c(this._$AH)?this._$AA.nextSibling.data=t:this.T(d.createTextNode(t)),this._$AH=t}$(t){const{values:i,_$litType$:e}=t,o="number"==typeof e?this._$AC(t):(void 0===e.el&&(e.el=E.createElement(C(e.h,e.h[0]),this.options)),e);if(this._$AH?._$AD===o)this._$AH.p(i);else{const t=new N(o,this),e=t.u(this.options);t.p(i),this.T(e),this._$AH=t}}_$AC(t){let i=w.get(t.strings);return void 0===i&&w.set(t.strings,i=new E(t)),i}k(t){g(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let e,o=0;for(const s of t)o===i.length?i.push(e=new O(this.O(p()),this.O(p()),this,this.options)):e=i[o],e._$AI(s),o++;o<i.length&&(this._$AR(e&&e._$AB.nextSibling,o),i.length=o)}_$AR(t=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);t&&t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class M{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,e,o,s){this.type=1,this._$AH=y,this._$AN=void 0,this.element=t,this.name=i,this._$AM=o,this.options=s,e.length>2||""!==e[0]||""!==e[1]?(this._$AH=Array(e.length-1).fill(new String),this.strings=e):this._$AH=y}_$AI(t,i=this,e,o){const s=this.strings;let r=!1;if(void 0===s)t=S(this,t,i,0),r=!c(t)||t!==this._$AH&&t!==x,r&&(this._$AH=t);else{const o=t;let n,l;for(t=s[0],n=0;n<s.length-1;n++)l=S(this,o[e+n],i,n),l===x&&(l=this._$AH[n]),r||=!c(l)||l!==this._$AH[n],l===y?t=y:t!==y&&(t+=(l??"")+s[n+1]),this._$AH[n]=l}r&&!o&&this.j(t)}j(t){t===y?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class B extends M{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===y?void 0:t}}class D extends M{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==y)}}class I extends M{constructor(t,i,e,o,s){super(t,i,e,o,s),this.type=5}_$AI(t,i=this){if((t=S(this,t,i,0)??y)===x)return;const e=this._$AH,o=t===y&&e!==y||t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive,s=t!==y&&(e===y||o);o&&this.element.removeEventListener(this.name,this,e),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class L{constructor(t,i,e){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=e}get _$AU(){return this._$AM._$AU}_$AI(t){S(this,t)}}const P=o.litHtmlPolyfillSupport;P?.(E,O),(o.litHtmlVersions??=[]).push("3.2.1")},73764:(t,i,e)=>{"use strict";e.d(i,{J:()=>o.J});var o=e(31006)}},i={};function e(o){var s=i[o];if(void 0!==s)return s.exports;var r=i[o]={id:o,exports:{}};return t[o](r,r.exports,e),r.exports}e.n=t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},e.d=(t,i)=>{for(var o in i)e.o(i,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:i[o]})},e.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t=e(38085),i=e(93811),o=e(95665),s=e(73764),r=e(30827),n=e(88373),l=e.n(n),a=function(t,i,e,o){var s,r=arguments.length,n=r<3?i:null===o?o=Object.getOwnPropertyDescriptor(i,e):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,i,e,o);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(n=(r<3?s(n):r>3?s(i,e,n):s(i,e))||n);return r>3&&n&&Object.defineProperty(i,e,n),n};const h=t.SHARED_COMPONENTS.Bookmark;class d extends r.y{constructor(){super(...arguments),this.marks=null,this.loggedUser=null,this.components=[t.SHARED_COMPONENTS.BookmarkHeader.TAG,t.SHARED_COMPONENTS.LinkPreview.TAG,t.SHARED_COMPONENTS.BookmarkExploreToolbar.TAG]}get linkPreviewProps(){var i,e,o,s,r,n,l,a,h,d,p,c,g,u,v,k,m,$;let f={};(null===(s=null===(o=null===(e=null===(i=this.props)||void 0===i?void 0:i.bookmark)||void 0===e?void 0:e.meta)||void 0===o?void 0:o.image)||void 0===s?void 0:s.url)&&(f.image=this.props.bookmark.meta.image);const b=null===(n=null===(r=this.props)||void 0===r?void 0:r.bookmark)||void 0===n?void 0:n.title;(null==b?void 0:b.length)&&(f.title=b);const _=null===(a=null===(l=this.props)||void 0===l?void 0:l.bookmark)||void 0===a?void 0:a.description;return(null==_?void 0:_.length)&&(f.description=_),{environment:null!==(d=null===(h=this.props)||void 0===h?void 0:h.environment)&&void 0!==d?d:t.productionEnvironment,url:null!==(g=null===(c=null===(p=this.props)||void 0===p?void 0:p.bookmark)||void 0===c?void 0:c.url)&&void 0!==g?g:"",metaDataFallback:{title:null===(v=null===(u=this.props)||void 0===u?void 0:u.bookmark)||void 0===v?void 0:v.title,url:null!==($=null===(m=null===(k=this.props)||void 0===k?void 0:k.bookmark)||void 0===m?void 0:m.url)&&void 0!==$?$:""},metaDataOverrides:f,loading:this.loading}}get bookmarkMetaData(){var i;return(0,t.bookmarkToMetaData)(null===(i=this.props)||void 0===i?void 0:i.bookmark)}get loading(){var t,i;return null===this.marks||(null===(t=this.props)||void 0===t?void 0:t.loading)||!(null===(i=this.props)||void 0===i?void 0:i.bookmark)}updated(t){var i;if(t.has("props")){const e=t.get("props");(null==e?void 0:e.bookmark)||!(null===(i=this.props)||void 0===i?void 0:i.bookmark)||this.marks||this.loadMarksForBookmark()}}loadMarksForBookmark(){var t,i,e,o;(null===(i=null===(t=this.props)||void 0===t?void 0:t.bookmark)||void 0===i?void 0:i._id)&&!this.marks&&("explore"===this.props.type?this.httpFacade.getPublicMarksForBookmark(null===(e=this.props.bookmark)||void 0===e?void 0:e._id):this.httpFacade.getMarksForBookmark(null===(o=this.props.bookmark)||void 0===o?void 0:o._id)).then((t=>{this.marks=t})).catch((()=>{this.marks=[]}))}get tags(){var i;return this.loading||!(null===(i=this.props)||void 0===i?void 0:i.bookmark)?["",""]:(0,t.distinctTagsForBookmarkAndMarks)(this.props.bookmark,this.marks)}get limitedTags(){var t,i;return(null===(t=this.tags)||void 0===t?void 0:t.length)>2?[...this.tags.slice(0,2),`... ${(null===(i=this.tags)||void 0===i?void 0:i.length)-2} more`]:this.tags}get highlightsCount(){var t;return(null!==(t=this.marks)&&void 0!==t?t:[]).length}get notesCount(){var t;return(null!==(t=this.marks)&&void 0!==t?t:[]).filter((t=>!!t.richText)).length}dispatchCustomEvent(t){this.dispatchEvent(new CustomEvent(t,{bubbles:!0}))}onDeleteBookmark(){this.dispatchCustomEvent("deleted")}onExportToMarkdown(){this.dispatchCustomEvent("exportedMarkdown")}get linkToBookmark(){var t,i,e,o,s;return`${null===(t=this.props)||void 0===t?void 0:t.bookmarkLinkUrl}${(null===(e=null===(i=this.props)||void 0===i?void 0:i.bookmarkLinkUrl)||void 0===e?void 0:e.endsWith("-"))?"":"/"}${null===(s=null===(o=this.props)||void 0===o?void 0:o.bookmark)||void 0===s?void 0:s._id}`}preventClick(t){t.preventDefault()}get metaDataForBookmark(){var i;return(0,t.bookmarkToMetaData)(null===(i=this.props)||void 0===i?void 0:i.bookmark)}onBookmarkLinkClicked(i){var e,o,s,r;if(this.props){if("function"==typeof(null===(e=this.props)||void 0===e?void 0:e.onBookmarkLinkClicked))return null===(o=this.props)||void 0===o?void 0:o.onBookmarkLinkClicked(i);if("private"!==(null===(s=this.props)||void 0===s?void 0:s.type))return(null===(r=this.props)||void 0===r?void 0:r.notificationInsteadLinkClick)?(this.preventClick(i),void t.notifications.dispatch(this.props.notificationInsteadLinkClick,{detail:{url:this.linkToBookmark}})):void 0;this.preventClick(i)}}get linkTitle(){var t,i;return`Go to highlights and notes of '${(null===(i=null===(t=this.props)||void 0===t?void 0:t.bookmark)||void 0===i?void 0:i.title)||"this bookmark."}'`}render(){var e,o,r,n;return this.props?i.html`
      <webhighlights-bookmark-header
        @deleted=${this.onDeleteBookmark}
        @exportedMarkdown=${this.onExportToMarkdown}
        .bookmark=${this.props.bookmark}
        .readOnly=${this.props.readOnly}
        .loading=${this.loading}
        .httpFacade=${this.httpFacade}
        .notificationInsteadLinkClick=${this.props.notificationInsteadLinkClick}
      ></webhighlights-bookmark-header>
      <a
        .href="${this.linkToBookmark}"
        class="bookmark-link"
        rel="${(0,s.J)((null===(e=this.linkToBookmark)||void 0===e?void 0:e.includes("web-highlights.com"))?void 0:"nofollow")}"
        title=${this.linkTitle}
        aria-label=${this.linkTitle}
        onclick="return"
        @click=${this.onBookmarkLinkClicked}
      >
        <webhighlights-link-preview
          part="link-preview"
          class="${this.props.type}"
          .metaData=${this.bookmarkMetaData}
          .props=${this.linkPreviewProps}
        ></webhighlights-link-preview>
      </a>
      <footer
        class="footer ${this.loading?"loading":""}"
        part="footer"
        data-testid=${h.TEST_IDS.FOOTER}
      >
        ${this.limitedTags.length?i.html`
              <div
                class="tags"
                data-testid=${h.TEST_IDS.FOOTER_TAGS_CONTAINER}
              >
                ${this.limitedTags.map((e=>i.html`
                    <span
                      class="tag"
                      data-testid=${h.TEST_IDS.FOOTER_TAG}
                      >${(0,t.truncateString)(e,15)}</span
                    >
                  `))}
              </div>
            `:i.html``}
        <span
          class="highlights-notes-info"
          data-testid=${h.TEST_IDS.HIGHLIGHT_AND_NOTES_INFO}
          >${this.highlightsCount}
          Highlight${1===this.highlightsCount?"":"s"} &amp;
          ${this.notesCount} Note${1===this.notesCount?"":"s"}
        </span>
      </footer>
      ${"explore"===this.props.type&&this.httpFacade?i.html`
            <webhighlights-bookmark-explore-toolbar
              @click=${this.preventClick}
              .userId=${null!==(r=null===(o=this.loggedUser)||void 0===o?void 0:o._id)&&void 0!==r?r:""}
              .bookmark=${null!==(n=this.props.bookmark)&&void 0!==n?n:null}
              .loading=${this.loading}
              .httpFacade=${this.httpFacade}
            ></webhighlights-bookmark-explore-toolbar>
          `:i.html``}
    `:i.html``}}d.styles=i.css`
    ${(0,i.unsafeCSS)(l())}
  `,a([(0,o.property)({type:Object})],d.prototype,"props",void 0),a([(0,o.property)({type:Array})],d.prototype,"marks",void 0),a([(0,o.property)({type:Object})],d.prototype,"loggedUser",void 0),a([(0,o.property)({type:Object})],d.prototype,"httpFacade",void 0),r.y.define("webhighlights-bookmark",d)})()})();